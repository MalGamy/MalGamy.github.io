---
title: Packed Malware Identification And Basic Analysis Part3   
layout: single
comments: true
share: true
related: true
author_profile: true
permalink: "/:title/"
tags:
- malware analysis 
- Unpacking 
categories:
- Articles
date: '2021-4-28 12-00-00 +0000'
toc: true
toc_label: Table of Contents
toc_sticky: true
---

# Introducation
I am so happy to write this article that describes the process of unpacking Maze sample and we know from [part1](https://malgamy.github.io/Packed-Malware-Identification-And-Basic-Analysis-part1/) and [part2](https://malgamy.github.io/Packed-Malware-Identification-And-Basic-Analysis-part2/) that this sample is packed.now I will write about unpacking the Maze ransomware sample with two way  the first way is unpacking the sample with GUI and the second way isunpacking with CLI.First. 

<!-- more -->

# sample 
We can donload the sample from [here](https://app.any.run/tasks/56248422-b327-4226-8a79-3155e24b999d/)

# Tools
1. [CFF Explorer](https://download.cnet.com/CFF-Explorer/3000-2383_4-10431156.html)
2. [Upx Tool](https://github.com/upx/upx)

# unpacking
## unpacking in GUI

I will fire the sample in ```CFF Explorer``` and got to ``` Section Headers``` tab.
 
<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116378406-63ab9900-a812-11eb-91a0-eb4d6f9697b3.PNG" width="100%">
</p>

In the previous image, we see both ```UPX0``` and ```UPX1``` . Now I will move to ```UPX Utility``` , which we can found at the end of the list of tab

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116379845-b33e9480-a813-11eb-9486-13b89c895351.PNG" width="100%">
</p>

to unpacking the ```Maze``` ransomware sample I will enable ``` Check if the Portable Executable is already Packed ``` and click on the button ``` Unpack ```

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116381164-ef262980-a814-11eb-8c9f-fc19c8bb9a29.PNG" width="100%">
</p>

you must confirm that you check ```checks if the PE sample is already packed or not``` and click on the ```Unpacking``` button and you can see the results after clicking the button which can be an indicator that the sample was unpacking successfully.

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116383830-84c2b880-a817-11eb-9ea6-34fa46ec8c2e.PNG" width="100%">
</p>

Now I will go to the Section Headers tab and you can see the details after unpacking the Maze ransomware sample.

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116383983-b045a300-a817-11eb-978b-774f11614aaa.PNG" width="100%">
</p>

go to ```File``` -> ```Save``` the sample as Maze_dump.exe, now I will go to the next way to unpacking the same sample with a different technique.

## unpacking with CLI

now I will use the ```CLI``` to unpack malware as we are dealing with a sample packed with ```UPX``` , you can copy the UPX tool in the same directory of the sample to make the process of unpacking easier and run the ```upx.exe``` in order to see the help tool menu which can help you.

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116394032-af663e80-a822-11eb-972c-5c404df44bde.PNG" width="100%">
</p>

From help menu i will use the ```-d``` switch and also I will the ```-o``` switch so I do not modify the sample itself by using these switches as I create a copy of the results which name ```UnpackedMaz.exe```

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/116395892-fbb27e00-a824-11eb-81c1-22d3ed614ec3.PNG" width="100%">
</p>

I finish my article today waite me in the next article.




