---
title: Deep Analysis Agent Tesla Malware
classes: wide
header:
  teaser: /img/Agent_Tesla.jpg
ribbon: MidnightBlue
categories:
  - Malware-Analysis
toc: true
---
# Agent Tesla 
Agent Tesla is a keylogger and information stealer. Security researchers discovered it in late 2014, the malware was sold in vinous forms and marketplaces and malware is owned by agentTesla.com. the malware has many features like screen clogging, clipboard logging, screen capturing, extracting stored passwords from many browsers, it supports all versions of the Windows operating system, and it's written in .NET

# Infect cycle 
Agent tesla infect victim's machine in cycle infect, it starts with Email attachment and this is the most common vector to infect victims machine by using social engineering and after satisfying user to enable macro embedded into an Email attachment. Malware will connect with c2 to download .Net malware into the system. .Net malware can be packed and obfuscated to evasion anti-viruses and security solutions.

<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/143674817-ddd0d6dd-3a64-4e6b-8ad8-760be3eb75b8.png">
</p>
<center><font size="3"><u>Figure</u>(1): <u>How Malware Infect Machine.</u></font> </center>
# Stage 1
## Aritfacts

| No.  | Description             | info                                                        |
| :--- | ----------------------- | ------------------------------------------------------------ |
| 1    | MD5 Hash                | af98b88c0b5dc353fbe536bd6fb8c4ec |
| 2    | SHA1 Hash               | 91dcc7418323004579a58f6fa3ea4f969127cde6 |
| 3    | File Size               | 200 KB                        |
| 4    | VirusTotal Detection    | 55/70                         |


<br>
## Identify packed
From some basic static analysis of the first stage, we can identify that the first stage is packed and we can see that with Detect it Easy tool to identify entropy of malware in the next figure.
<p align="center">
<img src="https://user-images.githubusercontent.com/74544712/143610570-9878e69a-634c-4641-b6eb-58782689e315.PNG">
</p>
<center><font size="3"><u>Figure</u>(2): <u>Identify Packed Malware.</u></font> </center> 

## Unpacking 
To fast the process of unpacking, I will use UNPACME website to unpack the first stage of malware, UNPACME will only extract packed or encrypted Windows Portable Executable (PE) files that are embedded in the submission. 
# Stage 2

