---
title: Emotet Malware 0x01
classes: wide
header:
  teaser: /img/Emotet.jpg
ribbon: MidnightBlue
categories:
  - Malware-Analysis
toc: true
---
# Introduction
In this part, we will play with code in ```X32dbg``` debugger to unpack Emotet malware and arrive to original entry point (OEP). So you should read the first part to understand this part.

# Sample
MD : CA06ACD3E1CAB1691A7670A5F23BAEF4
# Tools
x32 debugger 
# Jump Instruction 
## Step01
we will load binary of Emotet malware to ```32dbg``` and press ```F9``` to arrive to EntreyPoint and set break point on ```Jump ecx``` instruction and we can see the results in the next figure

![Figure01](https://user-images.githubusercontent.com/74544712/128159253-44179191-bdfb-4904-b8c3-0d50858d5eed.png)

## Step02
From the previous figure, we set break point on Jump ecx instruction. So we can do the next steps.
- Run the debugger by pressing F9 to execute the code till Jump ecx instruction
- And press F7 to execute code one step 
So we can see the steps in the next figure 

![Figure02](https://user-images.githubusercontent.com/74544712/128160816-90f3121c-7579-4287-a60c-b612496f98be.png)

# Abnormal Function 
By doing the previous steps, we can jump to another function. So we will examine it and get some information about instructions. After examining function we can identify some suspicious instruction in the end of function. So we can see the first instructions of function and suspicious end of the function in the next figure.

![Figure03](https://user-images.githubusercontent.com/74544712/128161935-0e36585a-983f-4ea0-b232-ded617310ddd.png)

From the previous figure, we can see the end of the function and the three suspicious instructions. 
```
mov edx,dword ptr ds:[41C1B4] ---> we will set Bp here 
push edx                      
ret

```
Set BP on the instruction ``` mov  edx , dword ptr ds:[41C1B4] ``` 
So, we will do the following steps to see what instructions do.
- Set BP on the instruction ``` mov  edx , dword ptr ds:[41C1B4] ``` 
- follow the value of ```dword ptr ds:[41C1B4]``` in dump to see what is. we can see that this possible packed code 
- press F7 
- and again  






